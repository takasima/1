<__trans_section component="<mt:var name="component">">
<$MTVersion setvar="version"$>
<mt:setvarblock name="html_title"><mt:if name="id"><mt:var name="obj_name" escape="html"> - <mt:Trans component="$component" phrase="Edit [_1]" params="$class_label"><mt:else><mt:Trans component="$component" phrase="Create [_1]" params="$class_label"></mt:else></mt:if></mt:setvarblock>
<mt:setvarblock name="page_title"><mt:if name="id"><mt:Trans component="$component" phrase="Edit [_1]" params="$class_label"><mt:ignore> - <mt:var name="obj_name" escape="html"></mt:ignore><mt:else><mt:Trans component="$component" phrase="Create [_1]" params="$class_label"></mt:else></mt:if></mt:setvarblock>
<mt:setvarblock name="html_head" append="1">
<style type="text/css">
fieldset textarea { height:240px }
.field input.full-width, .field textarea.full-width { width:100% }
.field .text { width:100% }
dd { margin-left:0px }
<mt:loop name="hidden_field">
#<mt:var name="field_name">-field{ display:none }
</mt:loop>
</style>
<script type="text/javascript">
function validation() {
    if ( jQuery( '#name-field:hidden' ).length ) {
        return true;
    }
    var name = jQuery( '#name' ).val();
    if ( name == '' ) {
        alert( '<mt:Trans component="$component" phrase="[_1] requires Name." params="$class_label">' );
        return false;
    }
    return true;
}
</script>
<mt:if name="use_wysiwyg">
<script type="text/javascript">
    <mt:IfPlugin component="TinyMCE">
    var editor_another_setting = true;
    var theme_advanced_buttons1 = '<$mt:var name="theme_advanced_buttons1" escape="js"$>';
    var theme_advanced_buttons2 = '<$mt:var name="theme_advanced_buttons2" escape="js"$>';
    var theme_advanced_buttons3 = '<$mt:var name="theme_advanced_buttons3" escape="js"$>';
    var theme_advanced_buttons4 = '<$mt:var name="theme_advanced_buttons4" escape="js"$>';
    var theme_advanced_buttons5 = '<$mt:var name="theme_advanced_buttons5" escape="js"$>';
    var editor_content_css = '<$mt:var name="editor_style_css" escape="js"$>';
    <mt:else>
    <link rel="stylesheet" href="<$mt:var name="static_uri"$>plugins/TinyMCE/css/TinyMCE.css" type="text/css" />
    <script type="text/javascript" src="<$mt:var name="static_uri"$>plugins/TinyMCE/lib/tinymce/jquery.tinymce.js"></script>
    <script type="text/javascript" src="<$mt:var name="static_uri"$>plugins/TinyMCE/js/TinyMCE.js"></script>
    <script type="text/javascript">
    tinymce_editor.init['language'] = '<mt:if name="lang" eq="ja">ja<mt:else>en</mt:else></mt:if>';
    tinymce_editor.init['plugins'] = 'advhr,advimage,advlink,contextmenu,emotions,fullscreen,inlinepopups,insertdatetime,layer,lists,media,pagebreak,paste,style,table,template,visualchars,xhtmlxtras';
    tinymce_editor.init['theme_advanced_buttons1'] = '<$mt:var name="theme_advanced_buttons1" escape="js"$>';
    tinymce_editor.init['theme_advanced_buttons2'] = '<$mt:var name="theme_advanced_buttons2" escape="js"$>';
    tinymce_editor.init['theme_advanced_buttons3'] = '<$mt:var name="theme_advanced_buttons3" escape="js"$>';
    tinymce_editor.init['theme_advanced_buttons4'] = '<$mt:var name="theme_advanced_buttons4" escape="js"$>';
    tinymce_editor.init['theme_advanced_buttons5'] = '<$mt:var name="theme_advanced_buttons5" escape="js"$>';
    tinymce_editor.init['content_css'] = '<$mt:var name="editor_style_css" escape="js"$>';
    tinymce_editor.sub_init['blog_id'] = '<$mt:var name="blog_id" escape="js"$>';
    tinymce_editor.trans['Insert_Image'] = '<__trans phrase="Insert Image" escape="js">';
    tinymce_editor.trans['Insert_File'] = '<__trans phrase="Insert File" escape="js">';
    tinymce_editor.trans['Insert_Link'] = '<__trans phrase="Insert Link" escape="js">';
    </mt:else>
    </mt:IfPlugin>

    <mt:unless name="editor_select">
    jQuery(function(){
        jQuery('#main-content textarea[name="body"]').tinymce(tinymce_editor.init);
    });
    </mt:unless>
</script>
</mt:if>
</mt:setvarblock>
<mt:setvar name="position_actions_bottom" value="1">
<mt:setvar name="options-class" value="absolute">
<mt:setvarblock name="html_body_footer">
<MTIgnore>
<mt:setvar name="show_display_options_link" value="1">
<mt:if name="version" like="/^5\.0/">
<mt:include name="include/display_options.tmpl">
<mt:else>
<mt:setvarblock name="display_options">
<div id="display-options-detail" class="display-options-detail detail">
    <mtapp:setting
        id="display_columns"
        label="<__trans phrase="Column">"
        label_class="top-label">
    <form method="get" action="<mt:var name="SCRIPT_URL">" id="display-options-form">
        <input type="hidden" name="__mode" value="update_list_prefs" />
        <input type="hidden" name="_type" value="<mt:var name="OBJECT_TYPE">" />
        <input type="hidden" name="return_args" value="<mt:var name="RETURN_ARGS" escape="html">" />
    <ul style="display:inline;">
    <li style="display:inline;margin-right:1em;">
    <label>
        <input type="checkbox" value="name"
            name="custom_prefs"
            class="main"
            id="custom-prefs-name"
        <mt:if name="display"> checked="checked"</mt:if> />
        <__trans phrase="Title"></label>
    </li>
    </ul>
    <ul style="display:inline;" id="customfields-options-loop">
    <mt:loop name="options_loop">
    <li style="display:inline;margin-right:1em;" id="custom-prefs-<mt:var name="cf_basename" escape="html">">
        <label>
        <input type="checkbox" value="cf_<mt:var name="cf_basename" escape="html">"
            name="custom_prefs"
            class="main"
            value="<mt:var name="cf_basename" escape="html">"
        <mt:if name="display"> checked="checked"</mt:if> />
        <mt:var name="cf_name" escape="html"></label>
    </li>
    </mt:loop>
    </ul>
    <ul style="display:inline;">
    <li style="display:inline;margin-right:1em;">
        <label>
        <input type="checkbox" value="keywords"
            name="custom_prefs"
            class="main"
            id="custom-prefs-keywords"
        <mt:if name="display"> checked="checked"</mt:if> />
        <__trans phrase="Keywords"></label>
    </li>
</ul>
            <button
                mt:command="submit"
                class="button"
                title="<__trans phrase="Save display options">"
                ><__trans phrase="Save"></button>
</form>
</mtapp:setting>
</div>
</mt:setvarblock>
</MTIgnore>
</mt:if>
</mt:setvarblock>
<mt:setvarblock name="system_msg">
    <mt:if name="loaded_revision">
        <mtapp:statusmsg
            id="loaded_revision"
            class="info">
            <__trans phrase="Restored revision (Date:[_1]).  The current status is: [_2]" params="<$mt:var name="rev_date" escape="html"$>%%<span class="icon-left-wide icon-<$mt:var name="current_status_text" lower_case="1">"><$mt:var name="current_status_label"$></span>">
        </mtapp:statusmsg>
        <mt:if name="missing_tags_rev">
        <mtapp:statusmsg
            id="missing_tags_rev"
            class="info">
            <__trans phrase="Some of tags in the revision could not be loaded because they have been removed.">
        </mtapp:statusmsg>
        </mt:if>
    </mt:if>
    <mt:if name="saved">
        <mtapp:statusmsg
           id="saved"
            class="success">
            <__trans phrase="Your changes have been saved.">
        </mtapp:statusmsg>
    </mt:if>
    <mt:if name="error">
        <mtapp:statusmsg
            id="generic-error"
            class="error">
            <mt:var name="error">
        </mtapp:statusmsg>
    </mt:if>
</mt:setvarblock>
<mt:setvartemplate name="action_buttons">
<div style="white-space:nowrap">
    <button
        type="submit"
        accesskey="s"
        onclick="return validation();"
        title="<mt:Trans component="$component" phrase="Save this [_1] (s)" params="$class_label">"
        class="publish action primary button"
        ><__trans phrase="Save"></button>
    <mt:if name="id">
    <button
        onclick="
        if ( window.confirm( '<mt:Trans component="$component" phrase="Are you sure you want to remove this [_1]?" params="$class_label">' ) ) {
            getByID( 'this_mode' ).value='delete';
            getByID( 'this_return_args' ).value='__mode=list<mt:if name="version" like="/^5\.0/">_customobject<mt:else>&amp;_type=<mt:var name="class" escape="html"></mt:if>&amp;blog_id=<mt:var name="blog_id">&amp;class=<mt:var name="class" escape="html">';
            this.form.submit();
        } else {
            return false;
        }
        "
        class="save action button"
        type="submit"
        accesskey="x"
        title="<__trans phrase="<mt:Trans component="$component" phrase="Delete this [_1] (x)" params="$class_label">">"
        class="delete action"
        ><__trans phrase="Delete"></button>
    </mt:if>
    <mt:if name="has_template">
    <button
        onclick="
            getByID( 'this_mode' ).value='preview_customobject';
            this.form.submit();"
        class="save action button"
        type="submit"
        accesskey="v"
        title="<mt:Trans component="$component" phrase="Preview this [_1] (v)" params="$class_label">"
        class="delete action"
        ><__trans phrase="Preview"></button>
    </mt:if>
</div>
</mt:setvartemplate>
<mt:setvarblock name="object_nav">
    <ul class="object-nav">
        <li id="previous-link"><mt:if name="previous_customobject_id"><a href="<mt:var name="script_url">?__mode=view&amp;_type=customobject&amp;id=<mt:var name="previous_customobject_id" escape="url">&amp;blog_id=<mt:var name="blog_id" escape="url">&amp;class=<mt:var name="class" escape="url">"><__trans phrase="Previous"></a><mt:else><span><__trans phrase="Previous"></span></mt:if></li>
        <li id="next-link"><mt:if name="next_customobject_id"><a href="<mt:var name="script_url">?__mode=view&amp;_type=customobject&amp;id=<mt:var name="next_customobject_id" escape="url">&amp;blog_id=<mt:var name="blog_id" escape="url">&amp;class=<mt:var name="class" escape="url">"><__trans phrase="Next"></a><mt:else><span><__trans phrase="Next"></span></mt:if></li>
    </ul>
</mt:setvarblock>

<mt:setvarblock name="related_content">
<mtapp:PageActions>
<mt:unless name="is_oracle">
<mtapp:widget
    id="entry-status-widget"
    class="status-widget"
    label="<__trans phrase="Status">">
  <mt:if name="new_object">
  <p class="zero-state"><__trans phrase="New [_1]" params="<mt:var name="object_label">"></p>
  <mt:else>
    <mt:if name="use_revision">
  <div class="revision-info">
      <mt:if name="rev_date">
    <p><__trans phrase="Revision: <strong>[_1]</strong>" params="<mt:var name="rev_date" escape="html">"></p>
    <a href="<mt:var name="script_url">?__mode=list_revision&amp;_type=<mt:if name="class"><mt:var name="class" escape="html"><mt:else>customobject</mt:else></mt:if>&amp;id=<$mt:var name="id" escape="url"$>&amp;blog_id=<$mt:var name="blog_id"$>&amp;r=<mt:var name="rev_number" escape="html">" class="mt-open-dialog" title="<__trans phrase="View revisions of this [_1]" params="<mt:var name="object_label">">"><__trans phrase="View revisions"></a>
      <mt:else>
    <p class="zero-state"><__trans phrase="No revision(s) associated with this [_1]" params="<mt:var name="object_label" lower_case="1" escape="html">"></p>
      </mt:if>
  </div>
    <mt:else>
    </mt:if>
  </mt:if>
</mtapp:widget>
</mt:unless>
<mtapp:widget
    id="object-publishing-widget"
    class="publishing-widget"
    label="<__trans phrase="Metadata">">
    <mtapp:setting
        id="tags"
        label_class="top-label"
        label="<__trans phrase="Tags">"
        show_hint="0">
    <input type="text" name="tags" id="tags" class="text full-width" value="<mt:var name="tags" escape="html">" />
    </mtapp:setting>
    <mtapp:setting
        id="authored_on_date"
        label_class="top-label"
        label="<__trans phrase="Publish Date">"
        show_hint="0">
        <input type="text" name="authored_on_date" id="authored_on_date" style="width:7em;" class="text date text-date" value="<mt:var name="authored_on_date" escape="html">" />
         @ <input type="text" name="authored_on_time" id="authored_on_time" style="width:5.5em;" class="text time" value="<mt:var name="authored_on_time" escape="html">" />
    </mtapp:setting>
    <div id="period_on_date-field" class="field field-top-label">
    <div class="field-header">
        <label id="period_on_date-label">
        <input style="vertical-align:middle" onchange="if(this.checked){getByID('period_on_date').focus();}" type="checkbox" name="set_period" id="set_period" value="1"<mt:if name="set_period"> checked="checked"</mt:if> />
        <input type="hidden" name="set_period" value="0" />
        <span style="vertical-align:middle"><__trans phrase="End date"></span></label>
    </div>
    <div class="field-content ">
        <input type="text" name="period_on_date" id="period_on_date" style="width:7em;" class="text date text-date" value="<mt:var name="period_on_date" escape="html">" />
         @ <input type="text" name="period_on_time" id="period_on_time" style="width:5.5em;" class="text time" value="<mt:var name="period_on_time" escape="html">" />
    </div>
    </div>
    <mtapp:setting
        id="basename"
        label_class="top-label"
        label="<__trans phrase="Basename">"
        show_hint="0">
    <input type="text" name="basename" id="basename" class="text" value="<mt:var name="basename" escape="html">" />
    </mtapp:setting>
    <mtapp:setting
        id="status"
        label_class="top-label"
        label="<__trans phrase="Status">"
        show_hint="0">
    <select name="status" id="status">
    <mt:if name="status_draft"><option value="1"<mt:if name="status" eq="1"> selected="selected"</mt:if>><__trans phrase="Draft"></option></mt:if>
    <mt:if name="status_review"><option value="3"<mt:if name="status" eq="3"> selected="selected"</mt:if>><__trans phrase="Review"></option></mt:if>
    <mt:if name="status_publishing"><option value="2"<mt:if name="status" eq="2"> selected="selected"</mt:if>><__trans phrase="Publishing"></option></mt:if>
    <mt:if name="status_future"><option value="4"<mt:if name="status" eq="4"> selected="selected"</mt:if>><__trans phrase="Future"></option></mt:if>
    <mt:if name="status_closed"><option value="5"<mt:if name="status" eq="5"> selected="selected"</mt:if>><__trans phrase="Closed"></option></mt:if>
    </select>
    </mtapp:setting>
    <mt:include name="include/folder_selector.tmpl">
<mt:if name="use_revision">
    <mtapp:setting
        id="revision-note"
        label="<__trans phrase="Change note">"
        label_class="top-label">
        <input type="text" name="revision-note" id="revision-note" class="text full" value="<mt:var name="revision-note" escape="html">" />
    </mtapp:setting>
</mt:if>
<mt:if name="position_actions_bottom">
    <mt:include name="include/actions_bar.tmpl" bar_position="bottom" hide_pager="1">
</mt:if>
</mtapp:widget>
</form>
</mt:setvarblock>

<mt:include name="include/header.tmpl">

<form method="post" action="<mt:var name="script_url">" enctype="multipart/form-data">
    <input type="hidden" name="id" value="<mt:var name="id" escape="html">" />
    <input type="hidden" name="blog_id" value="<mt:var name="blog_id" escape="html">" />
    <input type="hidden" name="__mode" id="this_mode" value="save" />
    <input type="hidden" name="action_name" value="" />
    <input type="hidden" name="itemset_action_input" value="" />
    <input type="hidden" name="_type" value="<mt:if name="class"><mt:var name="class" escape="html"><mt:else>customobject</mt:else></mt:if>" />
    <input type="hidden" name="class" value="<mt:var name="class" escape="html">" />
    <input type="hidden" name="return_args" id="this_return_args" value="<mt:var name="return_args" escape="html">" />
    <input type="hidden" name="magic_token" value="<mt:var name="magic_token">" />
<mt:if name="use_revision">
    <input type="hidden" name="save_revision" id="save_revision" value="1" />
</mt:if>
<mt:if name="position_actions_top">
    <mt:include name="include/actions_bar.tmpl" bar_position="top" hide_pager="1">
</mt:if>
<fieldset>
    <MTIgnore><h3><mt:var name="page_title"></h3></MTIgnore>
    <mtapp:setting
        id="name"
        label_class="top-label"
        label="<__trans phrase="Name">"
        show_hint="0"
        show_label="0"
        >
    <input type="text" name="name" id="name" <mt:if name="version" like="/^5\.0/">style="font-size:200%"</mt:if> class="title text full-width" value="<mt:var name="obj_name" escape="html">" />
    </mtapp:setting>
    <mt:if name="has_template">
    <mt:if name="permalink">
    <div id="permalink-field" class="field field-no-header" style="margin-top:-4px">
        <div class="field-header">
            <label id="permalink-label" for="permalink"><__trans phrase="Permalink"></label>
        </div>
        <div class="field-content">
        <strong><__trans phrase="Permalink:"></strong> <mt:var name="permalink" escape="html">
        <mt:if name="status" eq="2">
            <a class="button" href="<mt:var name="permalink" escape="html">" target="_blank"><__trans phrase="View"></a>
        </mt:if>
        </div>
    </div>
    </mt:if>
    </mt:if>

    <mtapp:setting
        id="body"
        label_class="field-top-label"
        label="<__trans phrase="Body">"
        show_hint="0"
        >
    <textarea class="text" name="body"><mt:var name="body" escape="html"></textarea>
    </mtapp:setting>

    <mtapp:setting
        id="keywords"
        label_class="field-top-label"
        label="<__trans phrase="Keywords">"
        show_hint="0"
        show_label="1"
        >
    <input type="text" name="keywords" id="keywords" class="text" value="<mt:var name="keywords" escape="html">" />
    </mtapp:setting>

<mt:ignore>
<mt:IfPlugin component="ObjectMemo">
<mt:if name="id">
    <mt:if name="show_memo">
    <ul>
    <mt:loop name="memo_loop">
    <li>
        <dl>
        <dt><strong><span id="memo_label_<mt:var name="memo_id">"><mt:var name="memo_label" escape="html"></span></strong> (<span id="memo_created_on_<mt:var name="memo_id">"><mt:var name="memo_created_on"><span>)
            <mt:if name="can_edit"><a href="<mt:var name="script_url">?__mode=view&amp;id=<mt:var name="memo_id">&amp;_type=objectmemo&amp;object_id=<mt:var name="id">&amp;object_class=<mt:if name="class"><mt:var name="class" escape="html"><mt:else>customobject</mt:else></mt:if>&amp;object_ds=customobject&amp;blog_id=<mt:var name="blog_id">"
                class="button mt-open-dialog"
                title="<__trans phrase="Edit memo">"
                ><__trans phrase="Edit"></a>
            </mt:if>
            <mt:if name="can_create_memo"><a href="<mt:var name="script_url">?__mode=view&amp;parent_id=<mt:var name="memo_id">&amp;_type=objectmemo&amp;object_id=<mt:var name="id">&amp;object_class=<mt:if name="class"><mt:var name="class" escape="html"><mt:else>customobject</mt:else></mt:if>&amp;object_ds=customobject&amp;blog_id=<mt:var name="blog_id">"
                class="button mt-open-dialog"
                title="<__trans phrase="Reply to this memo">"
                ><__trans phrase="Reply"></a>
            </mt:if>
        </dt>
        <dd><span id="memo_text_<mt:var name="memo_id">"><mt:var name="memo_text" escape="html"></span></dd>
        </dl>
    </li>
    </mt:loop>
    </ul>
    <mt:if name="can_create_memo">
    <mtapp:setting
        id="memo"
        label_class="field-top-label"
        label="<__trans phrase="Memo">"
        show_hint="0"
        show_label="0"
        >
            <a href="<mt:var name="script_url">?__mode=view&amp;_type=objectmemo&amp;object_id=<mt:var name="id">&amp;object_class=<mt:if name="class"><mt:var name="class" escape="html"><mt:else>customobject</mt:else></mt:if>&amp;object_ds=customobject&amp;blog_id=<mt:var name="blog_id">"
                class="button mt-open-dialog"
                title="<__trans phrase="Add new memo">"
                ><__trans phrase="Add new memo"></a><br /><br />
    </mtapp:setting>
    </mt:if>
    </mt:if>
</mt:if>
</mt:IfPlugin>
</mt:ignore>

<mt:if name="field_order">
<script type="text/javascript">
    var customobject_list = jQuery( '#customfields-loop' );
<MTIgnore>
<mt:unless name="version" like="/^5\.0/">
    var customobject_opt = jQuery( '#customfields-options-loop' );
</mt:unless>
</MTIgnore>
    var customobject_field_order = '<mt:var name="field_order" escape="js">';
    var sort_items = customobject_field_order.split( ',' );
    jQuery.each( sort_items, function( i ) {
        var list = jQuery( '#' + 'customfield_' + this + '-field' );
        customobject_list.append( list );
<MTIgnore>
<mt:unless name="version" like="/^5\.0/">
        var opt = jQuery( '#' + 'custom-prefs-' + this );
        customobject_opt.append( opt );
</mt:unless>
</MTIgnore>
    } );
</script>
</mt:if>
<mt:ignore>
    <mtapp:setting
        id="tags"
        label_class="top-label"
        label="<__trans phrase="Tags">"
        show_hint="0">
    <input type="text" name="tags" id="tags" class="text full-width" value="<mt:var name="tags" escape="html">" />
    </mtapp:setting>
    <mtapp:setting
        id="authored_on"
        label_class="top-label"
        label="<__trans phrase="Publish Date">"
        show_hint="0">
        <input type="text" name="authored_on_date" id="authored_on_date" style="width:7em;" class="text-date" value="<mt:var name="authored_on_date" escape="html">" />
        <input type="text" name="authored_on_time" id="authored_on_time" style="width:5.5em;" value="<mt:var name="authored_on_time" escape="html">" />
    </mtapp:setting>
    <mtapp:setting
        id="status"
        label_class="top-label"
        label="<__trans phrase="Status">"
        show_hint="0">
    <select name="status" id="status">
    <option value="1"<mt:if name="status" eq="1"> selected="selected"</mt:if>><__trans phrase="Draft"></option>
    <option value="2"<mt:unless name="status"> selected="selected"</mt:unless><mt:if name="status" eq="2"> selected="selected"</mt:if>><__trans phrase="Publishing"></option>
    </select>
    </mtapp:setting>

<mt:if name="position_actions_bottom">
    <mt:include name="include/actions_bar.tmpl" bar_position="bottom" hide_pager="1">
</mt:if>
</form>
</mt:ignore>

<mt:if name="position_actions_bottom">
    <mt:include name="include/actions_bar.tmpl" bar_position="bottom" hide_pager="1">
</mt:if>
</fieldset>

<script type="text/javascript">
/* <![CDATA[ */
App.bootstrapInline( false );
jQuery( function() {
    jQuery( 'input.text-date' ).datepicker( {
        dateFormat: 'yy-mm-dd',
        dayNamesMin: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],
        monthNames: ['-01', '-02', '-03', '-04', '-05', '-06', '-07', '-08', '-09', '-10', '-11', '-12'],
        showMonthAfterYear: true,
        prevText: '&lt;',
        nextText: '&gt;'
    } );
} );
function custom_insertHTML( html, target ) {
    var ed = Editor;
    ed.focus();
    ed.selection.moveToBookmark( ed.bookmark );
    ed.execCommand( 'mceInsertContent', false, html );
    //insert_at_caret( $( '#' + target ), html )
}
function insert_at_caret ( target, v ) {
    var area = target.get( 0 );
    area.focus();
    if ( jQuery.browser.msie ) { // FIXME
        var r = document.selection.createRange();
        r.text = v;
        r.select();
    } else {
        var s = area.value;
        var p = area.selectionStart;
        var np = p + v.length;
        area.value = s.substr( 0, p ) + v + s.substr( p );
        area.setSelectionRange( np, np );
    }
}
function toggle_editor(sel, target) {
    var val = jQuery(sel).val();
    if ( val == 0 ) {
        tinymce_editor.show(target);
    } else if ( val == 1 ) {
        tinymce_editor.remove(target);
    }
}
/* ]]> */
</script>
<mt:include name="include/footer.tmpl">
</__trans_section>
