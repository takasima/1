id  : BlogGroup
key : bloggroup
name: Blog Group
version: 1.2
author_name: Alfasado Inc.
author_link: http://alfasado.net/
description: '<__trans phrase="Blogs Grouping and Sorting Interface.">'
l10n_class: BlogGroup::L10N
blog_config_template: group_config.tmpl
system_config_template: group_config_system.tmpl

# TODO / New Install or Backword Compatible

config_settings:
    BlogGroupFieldScope:
        default: blog
    WebsiteGroupFieldScope:
        default: blog
    BlogWebsiteGroupFieldScope:
        default: blog
settings:
    default_module_bloggroup:
    default_module_websitegroup:
    default_module_blogwebsitegroup:
custom_groups:
    bloggroup:
        id: BlogGroup
        component: BlogGroup
        name: Blog Group
        name_plural: Blog Groups
        field_order: 2030
        field_name: Blog Group
        edit_permission: $bloggroup::BlogGroup::BlogGroup::edit_permission
        filter_class: blog
    websitegroup:
        id: WebsiteGroup
        component: BlogGroup
        name: Website Group
        name_plural: Website Groups
        field_order: 2031
        field_name: Website Group
        edit_permission: $bloggroup::BlogGroup::WebsiteGroup::edit_permission
        filter_class: website
    blogwebsitegroup:
        id: BlogWebsiteGroup
        component: BlogGroup
        name: Blog / Website Group
        name_plural: Blog / Website Groups
        field_order: 2032
        field_name: Blog/Website Group
        edit_permission: $bloggroup::BlogGroup::BlogWebsiteGroup::edit_permission
        filter_class:
            - blog
            - website
listing_screens:
    bloggroup:
        object_label: Blog Group
        primary: name
        default_sort_key: name
        condition: $customgroup::CustomGroup::Plugin::_group_permission
        view:
            - website
            - system
    websitegroup:
        object_label: Website Group
        primary: name
        default_sort_key: name
        condition: $customgroup::CustomGroup::Plugin::_group_permission
        view:
            - system
    blogwebsitegroup:
        object_label: Blog / Website Group
        primary: name
        default_sort_key: name
        condition: $customgroup::CustomGroup::Plugin::_group_permission
        view:
            - website
            - blog
            - system
system_filters:
    bloggroup: $customgroup::CustomGroup::Listing::system_filters
    websitegroup: $customgroup::CustomGroup::Listing::system_filters
    blogwebsitegroup: $customgroup::CustomGroup::Listing::system_filters
list_properties:
    bloggroup: $customgroup::CustomGroup::Listing::list_props
    websitegroup: $customgroup::CustomGroup::Listing::list_props
    blogwebsitegroup: $customgroup::CustomGroup::Listing::list_props
list_actions:
    bloggroup: $customgroup::CustomGroup::Listing::list_actions
    websitegroup: $customgroup::CustomGroup::Listing::list_actions
    blogwebsitegroup: $customgroup::CustomGroup::Listing::list_actions
# customfield_types: $customgroup::CustomGroup::Field::_customfield_types
permissions:
    blog.manage_bloggroup:
        label: Manage Blog Group
        group: blog_admin
        order: 1400
    blog.manage_websitegroup:
        label: Manage Website Group
        group: blog_admin
        order: 1401
    blog.manage_blogwebsitegroup:
        label: Manage Blog / Website Group
        group: blog_admin
        order: 1402
object_types:
    bloggroup: BlogGroup::BlogGroup
    websitegroup: BlogGroup::WebsiteGroup
    blogwebsitegroup: BlogGroup::BlogWebsiteGroup
applications:
    cms:
        menus:
            blog:list_bloggroup:
                label: Manage Groups
                mode: list
                args:
                    _type: bloggroup
                    blog_id: 0
                order: 400
                view:
                    - website
                    - system
                condition: $bloggroup::BlogGroup::BlogGroup::permission
            blog:create_bloggroup:
                label: Create Group
                mode: view
                args:
                    _type: bloggroup
                order: 500
                condition: $bloggroup::BlogGroup::BlogGroup::permission
                view:
                    - website
            website:list_websitegroup:
                label: Manage Groups
                mode: list
                args:
                    _type: websitegroup
                    blog_id: 0
                order: 400
                view:
                    - system
                condition: $bloggroup::BlogGroup::WebsiteGroup::permission
            website:create_websitegroup:
                label: Create Group
                mode: view
                args:
                    _type: websitegroup
                order: 500
                condition: $bloggroup::BlogGroup::WebsiteGroup::permission
                view:
                    - system
            objectgroup:blogwebsitegroup:
                label: Blog / Website Group
                mode: list
                args:
                    _type: blogwebsitegroup
                    blog_id: 0
                order: 200
                view:
                    - website
                    - system
                condition: $bloggroup::BlogGroup::BlogWebsiteGroup::permission
        content_actions:
            blogwebsitegroup:
                create_blogwebsitegroup:
                    class: icon-create
                    label: Create New
                    mode: view
                    args:
                        _type: blogwebsitegroup
                    condition: >
                        sub {
                            my $app = MT->instance();
                            if ( my $blog = $app->blog ) {
                                if ( $blog->is_blog ) {
                                    return 0;
                                }
                            }
                            return BlogGroup::BlogWebsiteGroup::permission;
                        }
callbacks:
    cms_pre_load_filtered_list.bloggroup: $customgroup::CustomGroup::Listing::_cms_pre_load_filtered_list
    cms_pre_load_filtered_list.websitegroup: $customgroup::CustomGroup::Listing::_cms_pre_load_filtered_list
    cms_pre_load_filtered_list.blogwebsitegroup: $customgroup::CustomGroup::Listing::_cms_pre_load_filtered_list
